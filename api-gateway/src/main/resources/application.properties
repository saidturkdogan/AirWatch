# API Gateway Configuration
server.port=8080
spring.application.name=api-gateway

# Circuit Breaker Configuration
spring.cloud.circuitbreaker.resilience4j.enabled=true

# Air Quality Service Routes
spring.cloud.gateway.routes[0].id=air-quality-service
spring.cloud.gateway.routes[0].uri=http://localhost:8081
spring.cloud.gateway.routes[0].predicates[0]=Path=/api/air-quality/**,/api/pollution-density/**
spring.cloud.gateway.routes[0].filters[0]=CircuitBreaker=airQualityCircuitBreaker

# Anomaly Detection Service Routes
spring.cloud.gateway.routes[1].id=anomaly-detection-service
spring.cloud.gateway.routes[1].uri=http://localhost:8082
spring.cloud.gateway.routes[1].predicates[0]=Path=/api/anomalies/**
spring.cloud.gateway.routes[1].filters[0]=CircuitBreaker=anomalyDetectionCircuitBreaker

# Notification Service Routes
spring.cloud.gateway.routes[2].id=notification-service
spring.cloud.gateway.routes[2].uri=http://localhost:8083
spring.cloud.gateway.routes[2].predicates[0]=Path=/api/notifications/**
spring.cloud.gateway.routes[2].filters[0]=CircuitBreaker=notificationCircuitBreaker

# Air Quality Service OpenAPI
spring.cloud.gateway.routes[3].id=air-quality-openapi
spring.cloud.gateway.routes[3].uri=http://localhost:8081
spring.cloud.gateway.routes[3].predicates[0]=Path=/air-quality/api-docs/**
spring.cloud.gateway.routes[3].filters[0]=RewritePath=/air-quality/api-docs(?<segment>/?.*),/api-docs${segment}
spring.cloud.gateway.routes[3].filters[1]=CircuitBreaker=airQualityCircuitBreaker,fallbackUri=forward:/fallback/api-docs

# Anomaly Detection Service OpenAPI
spring.cloud.gateway.routes[4].id=anomaly-detection-openapi
spring.cloud.gateway.routes[4].uri=http://localhost:8082
spring.cloud.gateway.routes[4].predicates[0]=Path=/anomaly-detection/api-docs/**
spring.cloud.gateway.routes[4].filters[0]=RewritePath=/anomaly-detection/api-docs(?<segment>/?.*),/api-docs${segment}
spring.cloud.gateway.routes[4].filters[1]=CircuitBreaker=anomalyDetectionCircuitBreaker,fallbackUri=forward:/fallback/api-docs

# Notification Service OpenAPI
spring.cloud.gateway.routes[5].id=notification-openapi
spring.cloud.gateway.routes[5].uri=http://localhost:8083
spring.cloud.gateway.routes[5].predicates[0]=Path=/notification/api-docs/**
spring.cloud.gateway.routes[5].filters[0]=RewritePath=/notification/api-docs(?<segment>/?.*),/api-docs${segment}
spring.cloud.gateway.routes[5].filters[1]=CircuitBreaker=notificationCircuitBreaker,fallbackUri=forward:/fallback/api-docs

# Fallback endpoint
spring.cloud.gateway.routes[6].id=fallback-api-docs
spring.cloud.gateway.routes[6].uri=forward:/fallback/api-docs
spring.cloud.gateway.routes[6].predicates[0]=Path=/fallback/api-docs

# Swagger Configuration
springdoc.api-docs.path=/api-docs
springdoc.swagger-ui.path=/swagger-ui.html
springdoc.info.title=API Gateway
springdoc.info.description=API Gateway for AirWatch project
springdoc.info.version=1.0.0

# Swagger UI for services
springdoc.swagger-ui.urls[0].name=air-quality-service
springdoc.swagger-ui.urls[0].url=/air-quality/api-docs
springdoc.swagger-ui.urls[1].name=anomaly-detection-service
springdoc.swagger-ui.urls[1].url=/anomaly-detection/api-docs
springdoc.swagger-ui.urls[2].name=notification-service
springdoc.swagger-ui.urls[2].url=/notification/api-docs

# Logging Configuration
logging.level.org.springframework.cloud.gateway=DEBUG
logging.level.org.springdoc=DEBUG